const Token = require("./Token");

class IdentityServiceToken extends Token {

    get appTid() {
        return this.payload.app_tid ?? this.payload.zone_uuid;
    }

    get customIssuer() {
        return this.payload.ias_iss ? this.payload.iss : null;
    }

    get issuer() {
        return this.payload.ias_iss || this.payload.iss;
    }

    get scimId() {
        return this.payload.scim_id;
    }

    // Methods for backward-compatibility
    getAppTID() {
        return this.appTid;
    }

    getCustomIssuer() {
        return this.customIssuer;
    }

    getZoneId() {
        return this.appTid;
    }
}

module.exports = IdentityServiceToken;