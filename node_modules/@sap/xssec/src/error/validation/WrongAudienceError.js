const Service = require("../../service/Service");
const TokenValidationError = require("./TokenValidationError");

class WrongAudienceError extends TokenValidationError {
    /** @type {string[]} token audiences */
    audiences;
    /** @type {Service|Service[]} service(s) on which context creation was attempted */
    service;

    constructor(token, service, message = "Token was issued for a different audience than this service.") {
        super(token, message);
        this.name = "WrongAudienceError";
        this.service = service;
        this.audiences = token.audiences;
    }
}

module.exports = WrongAudienceError;