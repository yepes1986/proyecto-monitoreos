"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.shouldExchangeToken = exports.exchangeToken = void 0;
const jwt_1 = require("./jwt");
const token_accessor_1 = require("./token-accessor");
/**
 * @internal
 * Make a token exchange from IAS token to XSUAA token.
 * @param options - Configuration for how to retrieve destinations from the destination service.
 * @returns Exchanged token.
 */
async function exchangeToken(jwt) {
    return (0, token_accessor_1.jwtBearerToken)(jwt, 'xsuaa');
}
exports.exchangeToken = exchangeToken;
/**
 * @internal
 * Checks whether the IAS token to XSUAA token exchange should be applied.
 * @param options - Configuration for how to retrieve destinations from the destination service.
 * @returns A boolean value, that indicates whether the token exchange should be applied.
 */
function shouldExchangeToken(options) {
    // iasToXsuaaTokenExchange is optional, token exchange is enabled by default
    return (options.iasToXsuaaTokenExchange !== false &&
        !!options.jwt &&
        !(0, jwt_1.isXsuaaToken)((0, jwt_1.decodeJwt)(options.jwt)));
}
exports.shouldExchangeToken = shouldExchangeToken;
//# sourceMappingURL=identity-service.js.map